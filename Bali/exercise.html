<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Exercise – Drag & Drop Game (20 items)</title>
<style>
:root{--accent:#0b91b5;--bg:#f7fbfd;--card:#fff;--muted:#64748b}
*{box-sizing:border-box}
body{font-family:Inter,system-ui,Arial;margin:0;background:var(--bg);color:#0f1724;overflow-x:hidden;scroll-behavior:smooth}
.header{background:linear-gradient(135deg,var(--accent),#6dd5ed);color:#fff;padding:28px 12px;text-align:center}
nav{display:flex;justify-content:center;gap:10px;background:#fff;padding:10px;box-shadow:0 2px 6px rgba(0,0,0,0.06);flex-wrap:wrap}
nav a{color:var(--accent);text-decoration:none;font-weight:600}
.container{max-width:1000px;margin:18px auto;padding:12px}
.controls{display:flex;gap:10px;justify-content:center;margin-bottom:12px;flex-wrap:wrap}
.btn{background:var(--accent);color:#fff;border:none;padding:10px 14px;border-radius:10px;font-size:1rem;cursor:pointer;transition:.2s}
.btn:hover{transform:scale(1.05)}
.btn-ghost{background:#eef6fb;color:var(--accent);border:1px solid rgba(11,145,181,0.12);padding:10px 12px;border-radius:10px}
.pager{text-align:center;margin-top:10px;font-weight:600}

.game-grid{display:grid;grid-template-columns:1fr;gap:18px;}
.card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 6px 20px rgba(15,23,36,0.04)}
.drag-list{display:flex;flex-direction:column;gap:10px;overflow:auto;padding-right:6px}
.drag-item{
  background:#e6f7fb;padding:12px 10px;border-radius:10px;cursor:grab;
  border:1px solid #d1f0fa;font-size:1rem;touch-action:none;
  transition:transform .25s ease, box-shadow .25s ease;
}
.drag-item.dragging{
  opacity:0.8;
  transform:scale(1.12) rotate(1deg);
  box-shadow:0 10px 18px rgba(0,0,0,0.15);
}

.droplist{display:flex;justify-content:space-between;flex-wrap:nowrap;gap:10px}
.drop-target{
  flex:1;border:2px dashed #dbeefd;border-radius:10px;display:flex;
  flex-direction:column;align-items:center;justify-content:center;
  background:#fbfeff;padding:8px;min-height:150px;position:relative;
  transition:all .25s ease;
}
.drop-target.hover{background:#e8f8ff;border-color:var(--accent);transform:scale(1.03)}
.drop-target img{width:100%;height:120px;object-fit:cover;border-radius:8px;transition:.25s}
.drop-target.filled{background:#dcfce7;border-color:#16a34a;transform:scale(1.05)}
.match-row{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
.result{margin-top:12px;font-weight:700}

/* responsive untuk HP */
@media(max-width:768px){
  .droplist{flex-direction:column;align-items:center}
  .drop-target{width:90%;max-width:320px}
  .drag-item{font-size:1.1rem;padding:14px}
  .drop-target img{height:160px}
  h3{font-size:1.1rem}
}
</style>
</head>
<body>
<header class="header">
  <h1>Exercise — Drag & Drop (20 items)</h1>
  <p style="margin:6px 0 0 0">Dibagi 4 set — tiap set 5 soal. Drag kalimat ke gambar yang sesuai.</p>
</header>

<nav>
  <a href="index.html">Home</a>
  <a href="lesson.html">Lesson</a>
  <a href="vocabulary.html">Vocabulary</a>
  <a href="quiz.html">Quiz</a>
</nav>

<div class="container">
  <div class="controls">
    <button class="btn" id="shuffleBtn">Shuffle (acak semua)</button>
    <button class="btn" id="startBtn">Start Game</button>
    <button class="btn-ghost" id="resetBtn">Reset</button>
  </div>

  <div id="gameArea" style="display:none">
    <div class="card game-grid">
      <div id="leftCol" class="card">
        <h3>Sentences</h3>
        <div id="dragList" class="drag-list"></div>
      </div>
      <div id="rightCol" class="card">
        <h3>Pictures</h3>
        <div id="dropList" class="droplist"></div>
      </div>
    </div>

    <div class="match-row" style="margin-top:12px">
      <button class="btn" id="checkBtn">Check Answers</button>
      <button class="btn" id="nextBtn">Next</button>
      <button class="btn-ghost" id="playAgain" style="display:none">Play Again</button>
    </div>

    <div class="pager" id="pager"></div>
    <div class="result" id="result"></div>
  </div>
</div>

<!-- Efek suara -->
<audio id="soundDrop" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_48e73c8f51.mp3?filename=click-124467.mp3" preload="auto"></audio>
<audio id="soundCorrect" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_58b3842ecf.mp3?filename=correct-2-46134.mp3" preload="auto"></audio>
<audio id="soundWrong" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_1f47cfd41f.mp3?filename=error-2-126514.mp3" preload="auto"></audio>

<script>
const ITEMS=[
{id:1,sentence:"Made was at the beach yesterday.",img:"beach.jpg",label:"Beach"},
{id:2,sentence:"Bu Niluh was in the kitchen last night.",img:"kitchen.jpg",label:"Kitchen"},
{id:3,sentence:"They were in the market on Sunday.",img:"market.jpg",label:"Market"},
{id:4,sentence:"We were in the swimming pool yesterday.",img:"pool.jpg",label:"Pool"},
{id:5,sentence:"I was in Tanah Lot Temple last weekend.",img:"temple.jpg",label:"Temple"},
{id:6,sentence:"My family was at the hotel yesterday.",img:"hotel.jpg",label:"Hotel"},
{id:7,sentence:"He was in the restaurant last night.",img:"restaurant.jpg",label:"Restaurant"},
{id:8,sentence:"We were in the art market last Monday.",img:"artmarket.jpg",label:"Art Market"},
{id:9,sentence:"She was in the park yesterday afternoon.",img:"park.jpg",label:"Park"},
{id:10,sentence:"They were in the classroom this morning.",img:"classroom.jpg",label:"Classroom"},
{id:11,sentence:"My father was in the office yesterday.",img:"office.jpg",label:"Office"},
{id:12,sentence:"My mother was in the garden last evening.",img:"garden.jpg",label:"Garden"},
{id:13,sentence:"We were in the playground yesterday.",img:"playground.jpg",label:"Playground"},
{id:14,sentence:"The tourists were in the traditional market.",img:"tradmarket.jpg",label:"Traditional Market"},
{id:15,sentence:"I was in the bus station yesterday morning.",img:"busstation.jpg",label:"Bus Station"},
{id:16,sentence:"We were in the airport last Sunday.",img:"airport.jpg",label:"Airport"},
{id:17,sentence:"My little brother was in the bedroom last night.",img:"bedroom.jpg",label:"Bedroom"},
{id:18,sentence:"They were in the living room yesterday.",img:"livingroom.jpg",label:"Living Room"},
{id:19,sentence:"She was in the library yesterday.",img:"library.jpg",label:"Library"},
{id:20,sentence:"We were in the rice field last weekend.",img:"ricefield.jpg",label:"Rice Field"}
];

let pool=[],page=0;const PAGE_SIZE=5;let totalScore=0;let dragged=null;let scrollInterval=null;
const sDrop=document.getElementById('soundDrop');
const sCorrect=document.getElementById('soundCorrect');
const sWrong=document.getElementById('soundWrong');

function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}

function renderPage(){
  const start=page*PAGE_SIZE,slice=pool.slice(start,start+PAGE_SIZE);
  const dragList=document.getElementById('dragList'),dropList=document.getElementById('dropList');
  dragList.innerHTML='';dropList.innerHTML='';
  const drags=shuffle(slice.map(it=>({id:it.id,sentence:it.sentence})));
  drags.forEach(d=>{
    const el=document.createElement('div');
    el.className='drag-item';el.draggable=true;el.dataset.id=d.id;el.textContent=d.sentence;
    enableTouchDrag(el);
    el.addEventListener('dragstart',()=>{dragged=el;el.classList.add('dragging');startAutoScroll();});
    el.addEventListener('dragend',()=>{el.classList.remove('dragging');dragged=null;stopAutoScroll();});
    dragList.appendChild(el);
  });
  const drops=shuffle(slice.map(it=>({id:it.id,img:it.img,label:it.label})));
  drops.forEach(d=>{
    const t=document.createElement('div');t.className='drop-target';t.dataset.id=d.id;
    const img=document.createElement('img');img.src='img/'+d.img;img.alt=d.label;
    const cap=document.createElement('div');cap.style.marginTop='8px';cap.textContent=d.label;
    t.appendChild(img);t.appendChild(cap);
    t.addEventListener('dragover',ev=>ev.preventDefault());
    t.addEventListener('dragenter',()=>t.classList.add('hover'));
    t.addEventListener('dragleave',()=>t.classList.remove('hover'));
    t.addEventListener('drop',ev=>{
      ev.preventDefault();t.classList.remove('hover');
      if(dragged){t.innerHTML='';t.appendChild(dragged);dropAnimation(t);autoCheck();}
    });
    dropList.appendChild(t);
  });
  document.getElementById('pager').innerText='Set '+(page+1)+' of '+Math.ceil(pool.length/PAGE_SIZE);
  document.getElementById('result').innerText='';
}

// efek animasi & suara drop
function dropAnimation(target){
  sDrop.currentTime=0; sDrop.play();
  target.classList.add('filled');
  setTimeout(()=>target.classList.remove('filled'),400);
}

// auto scroll saat drag ke pinggir layar
function startAutoScroll(){
  stopAutoScroll();
  scrollInterval=setInterval(()=>{
    if(!dragged)return;
    const y=window.event?.clientY || 0;
    const edge=100, speed=12;
    if(y<edge) window.scrollBy(0,-speed);
    if(y>window.innerHeight-edge) window.scrollBy(0,speed);
  },20);
}
function stopAutoScroll(){clearInterval(scrollInterval);}

// dukungan sentuh
function enableTouchDrag(el){
  el.addEventListener('touchstart',e=>{dragged=el;el.classList.add('dragging');startAutoScroll();},{passive:true});
  el.addEventListener('touchmove',e=>{
    const t=e.touches[0];
    if(t.clientY<100) window.scrollBy(0,-15);
    if(t.clientY>window.innerHeight-100) window.scrollBy(0,15);
  },{passive:true});
  el.addEventListener('touchend',e=>{
    stopAutoScroll();
    if(!dragged)return;
    const touch=e.changedTouches[0];
    const target=document.elementFromPoint(touch.clientX,touch.clientY);
    const drop=target&&target.closest('.drop-target');
    if(drop){drop.innerHTML='';drop.appendChild(dragged);dropAnimation(drop);autoCheck();}
    dragged.classList.remove('dragging');
    dragged=null;
  },{passive:true});
}

// cek otomatis setelah semua drop diisi
function autoCheck(){
  const targets=document.querySelectorAll('.drop-target');
  const allFilled=[...targets].every(t=>t.querySelector('.drag-item'));
  if(!allFilled) return;
  let correct=0;
  targets.forEach(t=>{
    const child=t.querySelector('.drag-item');
    if(child&&Number(child.dataset.id)===Number(t.dataset.id)){
      t.style.borderColor='#16a34a';t.style.background='#dcfce7';correct++;
    }else{
      t.style.borderColor='#ef4444';t.style.background='#fee2e2';
    }
  });
  if(correct===targets.length){sCorrect.play();} else {sWrong.play();}
  document.getElementById('result').innerText='Automatic check: '+correct+' / '+targets.length;
}

document.addEventListener('DOMContentLoaded',function(){
  document.getElementById('shuffleBtn').addEventListener('click',()=>{pool=shuffle(ITEMS.slice());page=0;alert('Items shuffled. Click Start Game to begin.');});
  document.getElementById('startBtn').addEventListener('click',()=>{if(pool.length===0)pool=shuffle(ITEMS.slice());page=0;totalScore=0;document.getElementById('gameArea').style.display='block';renderPage();});
  document.getElementById('resetBtn').addEventListener('click',()=>{pool=[];page=0;totalScore=0;document.getElementById('gameArea').style.display='none';document.getElementById('result').innerText='Game reset.';});
  document.getElementById('checkBtn').addEventListener('click',()=>autoCheck());
  document.getElementById('nextBtn').addEventListener('click',()=>{
    const targets=document.querySelectorAll('.drop-target');let correct=0;
    targets.forEach(t=>{const child=t.querySelector('.drag-item');if(child&&Number(child.dataset.id)===Number(t.dataset.id))correct++;});
    totalScore+=correct;
    if((page+1)*PAGE_SIZE>=pool.length){
      document.getElementById('result').innerText='Finished! Total correct: '+totalScore+' / '+pool.length;
      sCorrect.play();
      document.getElementById('playAgain').style.display='inline-block';
      document.getElementById('checkBtn').disabled=true;document.getElementById('nextBtn').disabled=true;return;
    }
    page++;renderPage();
  });
  document.getElementById('playAgain').addEventListener('click',()=>{
    pool=shuffle(ITEMS.slice());page=0;totalScore=0;renderPage();
    document.getElementById('playAgain').style.display='none';
    document.getElementById('checkBtn').disabled=false;document.getElementById('nextBtn').disabled=false;
  });
  pool=shuffle(ITEMS.slice());
});
</script>
</body>
</html>
